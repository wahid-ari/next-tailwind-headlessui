import { useContext, useState } from 'react';
import Head from 'next/head';
import BackToTop from '@components/BackToTop';
import ComponentRender from '@components/ComponentRender';
import Layout from '@components/Layout';
import Navbar from '@components/Navbar';
import { MoonIcon, SunIcon } from '@heroicons/react/outline';
import { GlobalContext } from '@utils/GlobalContext';

export default function PreviewComponent() {
  const { darkMode, setDarkMode } = useContext(GlobalContext);
  const [iframeKey, setIframeKey] = useState(0);

  function changeTheme() {
    setDarkMode(!darkMode);
    setIframeKey(iframeKey + 1);
  }

  const components = [
    {
      name: 'Link Button',
      url: '/component/LinkButtonRenderer',
      key: 1,
    },
    {
      name: 'Button',
      url: '/component/ButtonRenderer',
      key: 2,
    },
    {
      name: 'Badge',
      url: '/component/BadgeRenderer',
      key: 3,
    },
    {
      name: 'Alert Compact',
      url: '/component/AlertCompactRenderer',
      key: 4,
    },
    {
      name: 'Progress',
      url: '/component/ProgressRenderer',
      key: 5,
    },
    {
      name: 'Next/Image',
      url: '/component/NextImageRenderer',
      key: 6,
    },
  ];

  return (
    <div>
      <Head>
        <title>Components Renderer</title>
        <meta name='description' content='Generated by create next app' />
        <link rel='icon' href='/favicon.ico' />
      </Head>

      <Navbar />

      <Layout>
        <main className='mx-auto max-w-7xl px-4 pb-[35rem] pt-8 sm:px-6 md:px-8'>
          {components.map((item, index) => {
            return (
              <div key={index + 1}>
                <h2 className='mb-2 text-lg font-medium dark:text-white'>{item.name}</h2>
                <ComponentRender componentUrl={item.url} iframeKey={iframeKey} />
              </div>
            );
          })}

          <div className='fixed bottom-20 right-3 z-10 mx-4 rounded bg-gray-100 bg-opacity-20 !py-2 px-2 backdrop-blur backdrop-filter dark:bg-neutral-800 dark:bg-opacity-40 md:right-10'>
            {darkMode ? (
              <button
                onClick={changeTheme}
                aria-label='Change Theme'
                className='h-8 w-8 rounded-full bg-neutral-800 p-1 text-white transition-all duration-300 ease-in hover:bg-neutral-700'
              >
                <SunIcon />
              </button>
            ) : (
              <button
                onClick={changeTheme}
                aria-label='Change Theme'
                className='h-8 w-8 rounded-full bg-gray-100 p-1 transition-all duration-300 ease-in hover:bg-gray-200'
              >
                <MoonIcon />
              </button>
            )}
          </div>

          <BackToTop />
        </main>
      </Layout>
    </div>
  );
}
