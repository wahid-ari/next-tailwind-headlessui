import { useContext, useState } from 'react';
import Head from 'next/head';
import BackToTop from '@components/BackToTop';
import ComponentRender from '@components/ComponentRender';
import Layout from '@components/Layout';
import Navbar from '@components/Navbar';
import { MoonIcon, SunIcon } from '@heroicons/react/outline';
import { GlobalContext } from '@utils/GlobalContext';

export default function PreviewComponent() {
  const { darkMode, setDarkMode } = useContext(GlobalContext);
  const [iframeKey, setIframeKey] = useState(0);

  function changeTheme() {
    setDarkMode(!darkMode);
    setIframeKey(iframeKey + 1);
  }

  const components = [
    {
      name: 'Link Button',
      url: '/component/LinkButtonRenderer',
      key: 1,
    },
    {
      name: 'Button',
      url: '/component/ButtonRenderer',
      key: 2,
    },
    {
      name: 'Badge',
      url: '/component/BadgeRenderer',
      key: 3,
    },
    {
      name: 'Alert Compact',
      url: '/component/AlertCompactRenderer',
      key: 4,
    },
    {
      name: 'Progress',
      url: '/component/ProgressRenderer',
      key: 5,
    },
    {
      name: 'Next/Image',
      url: '/component/NextImageRenderer',
      key: 6,
    },
  ];

  return (
    <div>
      <Head>
        <title>Components Renderer</title>
        <meta name='description' content='Generated by create next app' />
        <link rel='icon' href='/favicon.ico' />
      </Head>

      <Navbar />

      <Layout>
        <main className='max-w-7xl mx-auto px-4 sm:px-6 md:px-8 pt-8 pb-[35rem]'>
          {components.map((item, index) => {
            return (
              <div key={index + 1}>
                <h2 className='font-medium text-lg dark:text-white mb-2'>{item.name}</h2>
                <ComponentRender componentUrl={item.url} iframeKey={iframeKey} />
              </div>
            );
          })}

          <div className='!py-2 px-2 rounded mx-4 bg-opacity-20 dark:bg-opacity-40 bg-gray-100 dark:bg-neutral-800 backdrop-filter backdrop-blur fixed bottom-20 right-3 md:right-10 z-10'>
            {darkMode ? (
              <button
                onClick={changeTheme}
                aria-label='Change Theme'
                className='w-8 h-8 p-1 transition-all ease-in duration-300 bg-neutral-800 hover:bg-neutral-700 text-white rounded-full'
              >
                <SunIcon />
              </button>
            ) : (
              <button
                onClick={changeTheme}
                aria-label='Change Theme'
                className='w-8 h-8 p-1 transition-all ease-in duration-300 bg-gray-100 hover:bg-gray-200 rounded-full'
              >
                <MoonIcon />
              </button>
            )}
          </div>

          <BackToTop />
        </main>
      </Layout>
    </div>
  );
}
